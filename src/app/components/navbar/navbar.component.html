<mat-toolbar color="primary">
  <mat-toolbar-row>
    <!-- Logo y título -->
    <div class="navbar-brand d-flex align-items-center">
      <img
        width="40"
        height="40"
        src="assets/angular_logo.png"
        alt="Angular Logo"
        title="Check List - Gestión de Tareas"
        class="me-3" />
      <h1 class="titulo mb-0">{{ title }}</h1>
    </div>

    <!-- Spacer para empujar el menú a la derecha -->
    <span class="flex-spacer"></span>

    <!-- Indicador de estado (opcional) -->
    <div class="status-indicator me-3" *ngIf="hasDataToExport">
      <mat-icon class="text-success" title="Datos guardados">cloud_done</mat-icon>
    </div>

    <!-- Menú principal -->
    <button mat-icon-button [matMenuTriggerFor]="mainMenu" aria-label="Menú principal" class="menu-trigger">
      <mat-icon>more_vert</mat-icon>
    </button>

    <mat-menu #mainMenu="matMenu" class="main-menu">
      <!-- Sección de Datos -->
      <div class="menu-section-header">
        <small class="text-muted px-3">DATOS</small>
      </div>

      <button mat-menu-item (click)="onImportClick()" [disabled]="importButtonDisabled">
        <mat-icon [class.spin]="isImporting">
          {{ isImporting ? 'sync' : 'upload' }}
        </mat-icon>
        <span>{{ importButtonText }}</span>
      </button>

      <button mat-menu-item (click)="onExportData()" [disabled]="exportButtonDisabled">
        <mat-icon [class.spin]="isExporting">
          {{ isExporting ? 'sync' : 'download' }}
        </mat-icon>
        <span>{{ exportButtonText }}</span>
      </button>

      <mat-divider></mat-divider>

      <!-- Sección de Aplicación -->
      <div class="menu-section-header">
        <small class="text-muted px-3">APLICACIÓN</small>
      </div>

      <button mat-menu-item (click)="onDesktopVersionClick()" disabled>
        <mat-icon>desktop_windows</mat-icon>
        <span>Escritorio</span>
        <small class="ms-auto text-muted">&nbsp;(Próximamente)</small>
      </button>

      <!-- Información de versión -->
      <div class="menu-footer">
        <div class="px-3 py-2">
          <div class="mt-1">
            <small class="text-muted">Versión {{ appVersion }} - © Carlos Mur</small>
          </div>
        </div>
      </div>
    </mat-menu>

    <!-- Input oculto para selección de archivos -->
    <input
      #fileInput
      type="file"
      accept=".json"
      (change)="onFileSelected($event)"
      style="display: none"
      aria-label="Seleccionar archivo para importar" />
  </mat-toolbar-row>
</mat-toolbar>

<!-- Barra de progreso para operaciones en curso -->
<mat-progress-bar mode="indeterminate" *ngIf="isExporting || isImporting" class="loading-bar"> </mat-progress-bar>
